<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>COTO - Gerencia de Recaudaciones</title>
  <link rel="apple-touch-icon" sizes="180x180" href="../ico/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="../ico/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../ico/favicon-16x16.png">
  <link rel="manifest" href="../ico/site.webmanifest">
  <link rel="mask-icon" href="../ico/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <link rel="stylesheet" href="../css/styles.css">
  <script src="https://kit.fontawesome.com/9a289aa4a3.js" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://use.typekit.net/lrd7mts.css">  <link
    href="https://fonts.googleapis.com/css2?family=Ubuntu:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&display=swap"
    rel="stylesheet">

</head>

<body>

  <div id="loader">
    <div class="loader-content">
      <img src="https://cesarcruz-coto.github.io/coto/img/coto.png" alt="Cargando">
      <div id="progress">0%</div>
    </div>
  </div>

  <div id="container-main">
    <div class="sidebar">
      <img src="https://cesarcruz-coto.github.io/coto/img/coto.png" alt="">
      <h1>Gerencia de<br>Recaudaciones</h1>

      

      <ul>
        <li><a href="../octubre-24/inicio.html">Inicio</a></li>
        <li><a href="../octubre-24/aconciliar.html">Mov. A Conciliar</a></li>
        <li><a href="../octubre-24/erroroperativo.html">EO. Sin Resolver</a></li>
        <li><a href="../octubre-24/fallos.html">Fallos de Caja</a></li>
        <li><a href="../octubre-24/gastos.html">Gastos</a></li>
        <li><a href="postulantes.html">Postulantes</a></li>
      </ul>

      <div class="perfil-container">
        <img id="perfilFoto" src="https://cesarcruz-coto.github.io/coto/img/invitado.png" alt="Foto de perfil"
          class="perfil-foto">
        <div class="perfil-info">
          <div class="puesto" id="puesto">Puesto</div>
          <div class="nombre" id="nombre">Nombre del Usuario</div>
          <div class="legajo" id="legajo">Legajo</div>
          <div class="logout"><button class="notification-btn">
                        <i class="fa-regular fa-bell fa-shake"></i>
                        <span class="notification-count" id="notification-count">0</span>
                      </button> <i class="fa-solid fa-gear"></i> <a id="logout">Cerrar Sesion</a></div>
        </div>
      </div>
    <!-- Menú hamburguesa -->
             <div class="hamburger" onclick="toggleMenu()">
                <span></span>
                <span></span>
                <span></span>
            </div>
</div>
    <div class="notification-container">
                        
            <div class="notification-panel" id="notification-panel">
              <h4>Notificaciones</h4>
              <ul id="notification-list"></ul>
              <p class="no-notifications">No tienes notificaciones</p>
            </div>
          </div>
        <div class="dashboard-container">

      <section id="info">
        <div class="info-item">
      
        <h2>Changelog - Version web 1.0</h2>
        <br>
          <p>27/07/24 - Version Beta - Puesta en marcha de dashboard.</p>
          <p>30/08/24 - Version Beta 0.1 - Se soluciono error en vista de graficos de evolutivos.</p>
          <p>15/09/24 - Version Beta 0.2 - Se modifica la base de datos del grafico.</p>
        </div>
      </section>

    </div>
  </div>

  <script src="../octubre-24/js/scripts.js"></script>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js";
    import { getFirestore, collection, addDoc, getDocs, updateDoc, doc, arrayUnion, getDoc } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore.js";
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-auth.js";
    import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-storage.js";
    import { usuarios } from 'https://cesarcruz-coto.github.io/coto/usuarios.js';  // Importa los usuarios desde el archivo

    const firebaseConfig = {
      apiKey: "AIzaSyBjDElF__Bcgo137GGf6hPRXhEp4BatD10",
      authDomain: "recaudaciones-26766.firebaseapp.com",
      projectId: "recaudaciones-26766",
      storageBucket: "recaudaciones-26766.appspot.com",
      messagingSenderId: "793331710217",
      appId: "1:793331710217:web:93d036faa48032a6f53bd8"
    };
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const storage = getStorage(app);
    const auth = getAuth();

    // Referencias a los elementos del perfil
    const nombreElement = document.getElementById("nombre");
    const puestoElement = document.getElementById("puesto");
    const legajoElement = document.getElementById("legajo");
    const perfilFotoElement = document.getElementById("perfilFoto");

    // Verificar si hay un usuario autenticado
    onAuthStateChanged(auth, (user) => {
      if (user) {
        // Obtener el correo electrónico del usuario autenticado
        const userEmail = user.email;

        // Buscar los datos del usuario en el JSON
        const userData = usuarios.find(u => u.email === userEmail);

        if (userData) {
          // Mostrar los datos en la interfaz
          nombreElement.textContent = userData.nombre;
          puestoElement.textContent = userData.puesto;
          legajoElement.textContent = userData.legajo;
          perfilFotoElement.src = userData.fotoPerfil;
        } else {
          alert("No se encontraron datos para este usuario.");
        }
      } else {
        // Si no hay usuario autenticado, redirigir al login
        window.location.href = '../index.html';
      }
    });

    // Cerrar sesión
    // Referencia al enlace de cerrar sesión
    const logoutLink = document.getElementById("logout");

    // Añadir evento click al enlace de cerrar sesión
    logoutLink.addEventListener('click', (e) => {
      e.preventDefault();
      signOut(auth).then(() => {
        // Redirigir al login después de cerrar sesión
        window.location.href = '../index.html';
      }).catch((error) => {
        console.error("Error al cerrar sesión:", error);
      });
    });
  </script>

</body>

</html>